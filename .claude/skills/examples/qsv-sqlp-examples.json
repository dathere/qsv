{
  "skill": "qsv-sqlp",
  "version": "12.0.0",
  "examples": [
    {
      "name": "headers",
      "description": "Headers",
      "command": "qsv sqlp "
    },
    {
      "name": "sqlp_join_cross",
      "description": "Sqlp Join Cross",
      "input": {
        "data": [
          [
            "h1",
            "h2"
          ],
          [
            "a",
            "b"
          ],
          [
            "c",
            "d"
          ]
        ],
        "filename": "letters.csv"
      },
      "command": "qsv sqlp \"select * from letters cross join numbers\"",
      "args": [
        "select * from letters cross join numbers"
      ],
      "expected": {
        "data": [
          [
            "h1",
            "h2",
            "h3",
            "h4"
          ],
          [
            "a",
            "b",
            "1",
            "2"
          ],
          [
            "a",
            "b",
            "3",
            "4"
          ],
          [
            "c",
            "d",
            "1",
            "2"
          ],
          [
            "c",
            "d",
            "3",
            "4"
          ]
        ]
      }
    },
    {
      "name": "sqlp_join_same_colname_1820",
      "description": "Sqlp Join Same Colname 1820",
      "input": {
        "data": [
          [
            "id",
            "data"
          ],
          [
            "1",
            "open"
          ]
        ],
        "filename": "one.csv"
      },
      "command": "qsv sqlp \"SELECT _t_1.id, _t_2.data FROM _t_1 JOIN _t_2 ON _t_1.id = _t_2.id\"",
      "args": [
        "SELECT _t_1.id, _t_2.data FROM _t_1 JOIN _t_2 ON _t_1.id = _t_2.id"
      ],
      "expected": {
        "data": [
          [
            "id",
            "data"
          ],
          [
            "1",
            "closed"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_groupby_orderby",
      "description": "Sqlp Boston311 Groupby Orderby",
      "command": "qsv sqlp \"&test_file\" \"r#\\\"select ward, count(*\"",
      "args": [
        "&test_file",
        "r#\"select ward, count(*"
      ],
      "expected": {
        "data": [
          [
            "ward",
            "cnt"
          ],
          [
            "Ward 3",
            "10"
          ],
          [
            "Ward 6",
            "7"
          ],
          [
            "Ward 1",
            "6"
          ],
          [
            "3",
            "5"
          ],
          [
            "Ward 20",
            "5"
          ],
          [
            "Ward 4",
            "5"
          ],
          [
            "Ward 5",
            "5"
          ],
          [
            "14",
            "4"
          ],
          [
            "Ward 13",
            "4"
          ],
          [
            "Ward 16",
            "4"
          ],
          [
            "Ward 18",
            "3"
          ],
          [
            "Ward 19",
            "3"
          ],
          [
            "Ward 7",
            "3"
          ],
          [
            "Ward 8",
            "3"
          ],
          [
            "03",
            "2"
          ],
          [
            "17",
            "2"
          ],
          [
            "22",
            "2"
          ],
          [
            "Ward 11",
            "2"
          ],
          [
            "Ward 21",
            "2"
          ],
          [
            " ",
            "1"
          ],
          [
            "01",
            "1"
          ],
          [
            "02",
            "1"
          ],
          [
            "04",
            "1"
          ],
          [
            "06",
            "1"
          ],
          [
            "07",
            "1"
          ],
          [
            "1",
            "1"
          ],
          [
            "10",
            "1"
          ],
          [
            "16",
            "1"
          ],
          [
            "18",
            "1"
          ],
          [
            "19",
            "1"
          ],
          [
            "21",
            "1"
          ],
          [
            "7",
            "1"
          ],
          [
            "8",
            "1"
          ],
          [
            "9",
            "1"
          ],
          [
            "Ward 10",
            "1"
          ],
          [
            "Ward 12",
            "1"
          ],
          [
            "Ward 14",
            "1"
          ],
          [
            "Ward 15",
            "1"
          ],
          [
            "Ward 17",
            "1"
          ],
          [
            "Ward 2",
            "1"
          ],
          [
            "Ward 22",
            "1"
          ],
          [
            "Ward 9",
            "1"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_groupby_orderby_all",
      "description": "Sqlp Boston311 Groupby Orderby All",
      "command": "qsv sqlp \"&test_file\" \"r#\\\"select ward, count(*\"",
      "args": [
        "&test_file",
        "r#\"select ward, count(*"
      ],
      "expected": {
        "data": [
          [
            "ward",
            "cnt"
          ],
          [
            " ",
            "1"
          ],
          [
            "01",
            "1"
          ],
          [
            "02",
            "1"
          ],
          [
            "03",
            "2"
          ],
          [
            "04",
            "1"
          ],
          [
            "06",
            "1"
          ],
          [
            "07",
            "1"
          ],
          [
            "1",
            "1"
          ],
          [
            "10",
            "1"
          ],
          [
            "14",
            "4"
          ],
          [
            "16",
            "1"
          ],
          [
            "17",
            "2"
          ],
          [
            "18",
            "1"
          ],
          [
            "19",
            "1"
          ],
          [
            "21",
            "1"
          ],
          [
            "22",
            "2"
          ],
          [
            "3",
            "5"
          ],
          [
            "7",
            "1"
          ],
          [
            "8",
            "1"
          ],
          [
            "9",
            "1"
          ],
          [
            "Ward 1",
            "6"
          ],
          [
            "Ward 10",
            "1"
          ],
          [
            "Ward 11",
            "2"
          ],
          [
            "Ward 12",
            "1"
          ],
          [
            "Ward 13",
            "4"
          ],
          [
            "Ward 14",
            "1"
          ],
          [
            "Ward 15",
            "1"
          ],
          [
            "Ward 16",
            "4"
          ],
          [
            "Ward 17",
            "1"
          ],
          [
            "Ward 18",
            "3"
          ],
          [
            "Ward 19",
            "3"
          ],
          [
            "Ward 2",
            "1"
          ],
          [
            "Ward 20",
            "5"
          ],
          [
            "Ward 21",
            "2"
          ],
          [
            "Ward 22",
            "1"
          ],
          [
            "Ward 3",
            "10"
          ],
          [
            "Ward 4",
            "5"
          ],
          [
            "Ward 5",
            "5"
          ],
          [
            "Ward 6",
            "7"
          ],
          [
            "Ward 7",
            "3"
          ],
          [
            "Ward 8",
            "3"
          ],
          [
            "Ward 9",
            "1"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_wnull_value",
      "description": "Sqlp Boston311 Wnull Value",
      "command": "qsv sqlp \"&test_file\" \"\n            \\\"select location_street_name, location_zipcode from _t_1 where location_zipcode is \\\\\n             null order by location_street_name limit 5\\\",\n        \"",
      "args": [
        "&test_file",
        "\n            \"select location_street_name, location_zipcode from _t_1 where location_zipcode is \\\n             null order by location_street_name limit 5\",\n        "
      ],
      "expected": {
        "data": [
          [
            "location_street_name",
            "location_zipcode"
          ],
          [
            "INTERSECTION Asticou Rd & Washington St",
            "Not Specified"
          ],
          [
            "INTERSECTION Charles River Plz & Cambridge St",
            "Not Specified"
          ],
          [
            "INTERSECTION Columbia Rd & E Cottage St",
            "Not Specified"
          ],
          [
            "INTERSECTION E Canton St & Albany St",
            "Not Specified"
          ],
          [
            "INTERSECTION Gallivan Blvd & Washington St",
            "Not Specified"
          ]
        ]
      }
    },
    {
      "name": "sqlp_decimal_comma_issue_1050",
      "description": "Sqlp Decimal Comma Issue 1050",
      "command": "qsv sqlp \"&test_file\"",
      "args": [
        "&test_file"
      ],
      "options": {
        "--decimal-comma": "select COD_LOCALE_PROGETTO, FINANZ_UE from _t_1"
      },
      "tags": [
        "regression",
        "custom-delimiter"
      ]
    },
    {
      "name": "sqlp_null_aware_equality_checks",
      "description": "Sqlp Null Aware Equality Checks",
      "input": {
        "data": [
          [
            "a",
            "b"
          ],
          [
            "1",
            "1"
          ],
          [
            "",
            ""
          ],
          [
            "3",
            "3"
          ],
          [
            "6",
            "4"
          ],
          [
            "5",
            ""
          ]
        ],
        "filename": "test_null.csv"
      },
      "command": "qsv sqlp test_null.csv \"\n            r#\\\"SELECT (a = b\"",
      "args": [
        "test_null.csv",
        "\n            r#\"SELECT (a = b"
      ],
      "expected": {
        "data": [
          [
            "1_eq_unaware",
            "2_neq_unaware",
            "3_eq_aware",
            "4_eq_aware",
            "5_neq_aware"
          ],
          [
            "true",
            "false",
            "true",
            "true",
            "false"
          ],
          [
            "NULL",
            "NULL",
            "true",
            "true",
            "false"
          ],
          [
            "true",
            "false",
            "true",
            "true",
            "false"
          ],
          [
            "false",
            "true",
            "false",
            "false",
            "true"
          ],
          [
            "NULL",
            "NULL",
            "false",
            "false",
            "true"
          ]
        ]
      }
    },
    {
      "name": "sqlp_rnull_values_wnull_value",
      "description": "Sqlp Rnull Values Wnull Value",
      "command": "qsv sqlp test_null.csv \"SELECT * FROM test_null\"",
      "args": [
        "test_null.csv",
        "SELECT * FROM test_null"
      ],
      "expected": {
        "data": [
          [
            "a",
            "b"
          ],
          [
            "1",
            "NULL"
          ],
          [
            "2",
            "NULL"
          ],
          [
            "3",
            "NULL"
          ],
          [
            "4",
            "4"
          ],
          [
            "5",
            "NULL"
          ],
          [
            "6",
            "6"
          ],
          [
            "7",
            "DUNNO"
          ]
        ]
      }
    },
    {
      "name": "sqlp_regex_operators",
      "description": "Sqlp Regex Operators",
      "input": {
        "data": [
          [
            "n",
            "sval"
          ],
          [
            "1",
            "ABC"
          ],
          [
            "2",
            "abc"
          ],
          [
            "3",
            "000"
          ],
          [
            "4",
            "A0C"
          ],
          [
            "5",
            "a0c"
          ]
        ],
        "filename": "test_regex.csv"
      },
      "command": "qsv sqlp test_regex.csv \"r#\\\"SELECT * FROM test_regex WHERE sval ~ '\\\\d'\\\"#\" test_regex.csv \"r#\\\"SELECT * FROM test_regex WHERE sval ~* '^a0'\\\"#\" test_regex.csv \"r#\\\"SELECT * FROM test_regex WHERE sval !~ '^a0'\\\"#\" test_regex.csv \"r#\\\"SELECT * FROM test_regex WHERE sval !~* '^a0'\\\"#\"",
      "args": [
        "test_regex.csv",
        "r#\"SELECT * FROM test_regex WHERE sval ~ '\\d'\"#",
        "test_regex.csv",
        "r#\"SELECT * FROM test_regex WHERE sval ~* '^a0'\"#",
        "test_regex.csv",
        "r#\"SELECT * FROM test_regex WHERE sval !~ '^a0'\"#",
        "test_regex.csv",
        "r#\"SELECT * FROM test_regex WHERE sval !~* '^a0'\"#"
      ],
      "expected": {
        "data": [
          [
            "n",
            "sval"
          ],
          [
            "3",
            "000"
          ],
          [
            "4",
            "A0C"
          ],
          [
            "5",
            "a0c"
          ]
        ]
      }
    },
    {
      "name": "sqlp_regexp_like",
      "description": "Sqlp Regexp Like",
      "input": {
        "data": [
          [
            "scol"
          ],
          [
            "abcde"
          ],
          [
            "abc"
          ],
          [
            "a"
          ],
          [
            ""
          ]
        ],
        "filename": "test_regexp_like.csv"
      },
      "command": "qsv sqlp test_regexp_like.csv \"r#\\\"SELECT scol FROM test_regexp_like where REGEXP_LIKE(scol,'(C|D\"",
      "args": [
        "test_regexp_like.csv",
        "r#\"SELECT scol FROM test_regexp_like where REGEXP_LIKE(scol,'(C|D"
      ],
      "expected": {
        "data": [
          [
            "scol"
          ],
          [
            "abcde"
          ],
          [
            "abc"
          ]
        ]
      }
    },
    {
      "name": "sqlp_string_functions",
      "description": "Sqlp String Functions",
      "input": {
        "data": [
          [
            "scol"
          ],
          [
            "abcdE"
          ],
          [
            "abc"
          ],
          [
            "    abc"
          ],
          [
            "a"
          ],
          [
            "b"
          ]
        ],
        "filename": "test_strings.csv"
      },
      "command": "qsv sqlp test_strings.csv \"r#\\\"SELECT starts_with(scol, 'a'\" test_strings.csv \"r#\\\"SELECT ends_with(scol, 'c'\" test_strings.csv \"r#\\\"SELECT left(scol, 3\" test_strings.csv \"r#\\\"SELECT substr(scol, 2, 2\" test_strings.csv \"r#\\\"SELECT upper(scol\" test_strings.csv \"r#\\\"SELECT lower(scol\" test_strings.csv \"r#\\\"SELECT length(scol\" test_strings.csv \"r#\\\"SELECT octet_length(scol\"",
      "args": [
        "test_strings.csv",
        "r#\"SELECT starts_with(scol, 'a'",
        "test_strings.csv",
        "r#\"SELECT ends_with(scol, 'c'",
        "test_strings.csv",
        "r#\"SELECT left(scol, 3",
        "test_strings.csv",
        "r#\"SELECT substr(scol, 2, 2",
        "test_strings.csv",
        "r#\"SELECT upper(scol",
        "test_strings.csv",
        "r#\"SELECT lower(scol",
        "test_strings.csv",
        "r#\"SELECT length(scol",
        "test_strings.csv",
        "r#\"SELECT octet_length(scol"
      ],
      "expected": {
        "data": [
          [
            "scol"
          ],
          [
            "true"
          ],
          [
            "true"
          ],
          [
            "false"
          ],
          [
            "true"
          ],
          [
            "false"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_try_parsedates",
      "description": "Sqlp Boston311 Try Parsedates",
      "command": "qsv sqlp \"&test_file\"",
      "args": [
        "&test_file"
      ],
      "options": {
        "--ignore-errors": "true",
        "--try-parsedates": "\n            \"select ward, cast(avg(closed_dt - open_dt"
      },
      "expected": {
        "data": [
          [
            "ward",
            "avg_tat"
          ],
          [
            "Ward 11",
            "4847760000000.0"
          ],
          [
            "01",
            "4818270000000.0"
          ],
          [
            "Ward 13",
            "1518365750000.0"
          ],
          [
            "Ward 15",
            "1278926000000.0"
          ],
          [
            "Ward 21",
            "878446000000.0"
          ],
          [
            "Ward 14",
            "618933000000.0"
          ],
          [
            "Ward 3",
            "437691444444.0"
          ],
          [
            "Ward 5",
            "411909500000.0"
          ],
          [
            "Ward 20",
            "367233000000.0"
          ],
          [
            "9",
            "353495000000.0"
          ],
          [
            "Ward 18",
            "249882000000.0"
          ],
          [
            "19",
            "212566000000.0"
          ],
          [
            "Ward 4",
            "112872600000.0"
          ],
          [
            "Ward 1",
            "107850666666.0"
          ],
          [
            "Ward 10",
            "104110000000.0"
          ],
          [
            "16",
            "93557000000.0"
          ],
          [
            "Ward 19",
            "84164000000.0"
          ],
          [
            "10",
            "79101000000.0"
          ],
          [
            "21",
            "77717000000.0"
          ],
          [
            "7",
            "74611000000.0"
          ],
          [
            "17",
            "70117500000.0"
          ],
          [
            "3",
            "68836600000.0"
          ],
          [
            "Ward 9",
            "64097000000.0"
          ],
          [
            "Ward 12",
            "62930000000.0"
          ],
          [
            "Ward 6",
            "54770166666.0"
          ],
          [
            "Ward 7",
            "38346333333.0"
          ],
          [
            "Ward 8",
            "32767500000.0"
          ],
          [
            "03",
            "29810500000.0"
          ],
          [
            "07",
            "25328000000.0"
          ],
          [
            "22",
            "23919000000.0"
          ],
          [
            "14",
            "20786500000.0"
          ],
          [
            "Ward 22",
            "13524000000.0"
          ],
          [
            "1",
            "9469000000.0"
          ],
          [
            "06",
            "5290000000.0"
          ],
          [
            "Ward 16",
            "4533666666.0"
          ],
          [
            "8",
            "1757000000.0"
          ],
          [
            "02",
            "1650000000.0"
          ],
          [
            "18",
            "507000000.0"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_try_parsedates_precision",
      "description": "Sqlp Boston311 Try Parsedates Precision",
      "command": "qsv sqlp \"&test_file\"",
      "args": [
        "&test_file"
      ],
      "options": {
        "--ignore-errors": "true",
        "--try-parsedates": "\n            \"select ward, cast(avg(closed_dt - open_dt"
      },
      "expected": {
        "data": [
          [
            "ward",
            "avg_tat"
          ],
          [
            "Ward 11",
            "4847760000000.000"
          ],
          [
            "01",
            "4818270000000.000"
          ],
          [
            "Ward 13",
            "1518365750000.000"
          ],
          [
            "Ward 15",
            "1278926000000.000"
          ],
          [
            "Ward 21",
            "878446000000.000"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_try_parsedates_format",
      "description": "Sqlp Boston311 Try Parsedates Format",
      "command": "qsv sqlp \"&test_file\"",
      "args": [
        "&test_file"
      ],
      "options": {
        "--try-parsedates": "select closed_dt, open_dt from _t_1 where case_status = 'Closed' limit 5",
        "--ignore-errors": "true"
      },
      "expected": {
        "data": [
          [
            "closed_dt",
            "open_dt"
          ],
          [
            "Wed 2022-01-19 11:42:16",
            "Wed 2022-01-19 11:18:00"
          ],
          [
            "Sun 2022-01-09 06:43:06",
            "Sat 2022-01-08 12:54:49"
          ],
          [
            "Mon 2022-01-10 08:42:23",
            "Sat 2022-01-01 00:16:00"
          ],
          [
            "Thu 2022-01-20 08:45:03",
            "Thu 2022-01-20 08:07:49"
          ],
          [
            "Thu 2022-01-20 08:45:12",
            "Thu 2022-01-20 08:15:45"
          ]
        ]
      }
    },
    {
      "name": "sqlp_comments",
      "description": "Sqlp Comments",
      "input": {
        "data": [
          [
            "# test file to see how comments work",
            ""
          ],
          [
            "# this is another comment before the header",
            ""
          ],
          [
            "# DATA DICTIONARY",
            ""
          ],
          [
            "# column1 - alphabetic; id of the column",
            ""
          ],
          [
            "# column2 - numeric; just a number",
            ""
          ],
          [
            "column1",
            "column2"
          ],
          [
            "a",
            "1"
          ],
          [
            "#b",
            "2"
          ],
          [
            "c",
            "3"
          ],
          [
            "#d - this row is corrupted skip",
            "extra col2"
          ],
          [
            "e",
            "5"
          ]
        ],
        "filename": "comments.csv"
      },
      "command": "qsv sqlp comments.csv \"select column1, column2 from comments order by column2 desc\"",
      "args": [
        "comments.csv",
        "select column1, column2 from comments order by column2 desc"
      ],
      "expected": {
        "data": [
          [
            "column1",
            "column2"
          ],
          [
            "e",
            "5"
          ],
          [
            "c",
            "3"
          ],
          [
            "a",
            "1"
          ]
        ]
      }
    },
    {
      "name": "sqlp_compress",
      "description": "Sqlp Compress",
      "input": {
        "data": [
          [
            "column1",
            "column2"
          ],
          [
            "a",
            "1"
          ],
          [
            "c",
            "3"
          ],
          [
            "e",
            "5"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"select column1, column2 from data order by column2 desc\" decompress out_file",
      "args": [
        "data.csv",
        "select column1, column2 from data order by column2 desc",
        "decompress",
        "out_file"
      ],
      "expected": {
        "data": [
          [
            "column1",
            "column2"
          ],
          [
            "e",
            "5"
          ],
          [
            "c",
            "3"
          ],
          [
            "a",
            "1"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_explain",
      "description": "Sqlp Boston311 Explain",
      "command": "qsv sqlp \"&test_file\"",
      "args": [
        "&test_file"
      ],
      "options": {
        "--try-parsedates": "\n        \"explain select ward, cast(avg(closed_dt - open_dt"
      }
    },
    {
      "name": "sqlp_boston311_sql_script_jsonl_cache_schema",
      "description": "Sqlp Boston311 Sql Script Jsonl Cache Schema",
      "command": "qsv sqlp \"&test_file\" test.sql",
      "args": [
        "&test_file",
        "test.sql"
      ]
    },
    {
      "name": "sqlp_boston311_cte_gz",
      "description": "Sqlp Boston311 Cte Gz",
      "command": "qsv sqlp \"&test_file\" \"\n        r#\\\"with boston311_roxbury as (select * from read_csv('boston311-100.csv.gz'\"",
      "args": [
        "&test_file",
        "\n        r#\"with boston311_roxbury as (select * from read_csv('boston311-100.csv.gz'"
      ],
      "expected": {
        "data": [
          [
            "ward",
            "cnt"
          ],
          [
            "Ward 11",
            "2"
          ],
          [
            "Ward 13",
            "2"
          ],
          [
            "Ward 8",
            "2"
          ],
          [
            "14",
            "1"
          ],
          [
            "Ward 12",
            "1"
          ]
        ]
      }
    },
    {
      "name": "sqlp_boston311_case_expression",
      "description": "Sqlp Boston311 Case Expression",
      "command": "qsv sqlp \"&test_file\" \"\n        r#\\\"SELECT case_enquiry_id, \n           CASE closed_dt is null and case_title ~* 'graffiti' \n              WHEN True THEN 'Yes' \n              WHEN False THEN 'No' \n              ELSE 'N/A'\n           END as graffiti_related\n           from _t_1\n           where case_status = 'Open'\\\"#,\n    \"",
      "args": [
        "&test_file",
        "\n        r#\"SELECT case_enquiry_id, \n           CASE closed_dt is null and case_title ~* 'graffiti' \n              WHEN True THEN 'Yes' \n              WHEN False THEN 'No' \n              ELSE 'N/A'\n           END as graffiti_related\n           from _t_1\n           where case_status = 'Open'\"#,\n    "
      ],
      "expected": {
        "data": [
          [
            "case_enquiry_id",
            "graffiti_related"
          ],
          [
            "101004143000",
            "No"
          ],
          [
            "101004155594",
            "No"
          ],
          [
            "101004154423",
            "No"
          ],
          [
            "101004141848",
            "No"
          ],
          [
            "101004113313",
            "No"
          ],
          [
            "101004113751",
            "Yes"
          ],
          [
            "101004113902",
            "Yes"
          ],
          [
            "101004113473",
            "No"
          ],
          [
            "101004113604",
            "No"
          ],
          [
            "101004114154",
            "Yes"
          ],
          [
            "101004114383",
            "No"
          ],
          [
            "101004114795",
            "Yes"
          ],
          [
            "101004118346",
            "Yes"
          ],
          [
            "101004115302",
            "No"
          ],
          [
            "101004115066",
            "No"
          ]
        ]
      },
      "tags": [
        "case-sensitivity"
      ]
    },
    {
      "name": "sqlp_boston311_case_expression_zlib",
      "description": "Sqlp Boston311 Case Expression Zlib",
      "command": "qsv sqlp \"&test_file\" \"\n        r#\\\"SELECT case_enquiry_id, \n           CASE closed_dt is null and case_title ~* 'graffiti' \n              WHEN True THEN 'Yes' \n              WHEN False THEN 'No' \n              ELSE 'N/A'\n           END as graffiti_related\n           from read_csv('boston311-100.csv.zlib'\"",
      "args": [
        "&test_file",
        "\n        r#\"SELECT case_enquiry_id, \n           CASE closed_dt is null and case_title ~* 'graffiti' \n              WHEN True THEN 'Yes' \n              WHEN False THEN 'No' \n              ELSE 'N/A'\n           END as graffiti_related\n           from read_csv('boston311-100.csv.zlib'"
      ],
      "expected": {
        "data": [
          [
            "case_enquiry_id",
            "graffiti_related"
          ],
          [
            "101004143000",
            "No"
          ],
          [
            "101004155594",
            "No"
          ],
          [
            "101004154423",
            "No"
          ],
          [
            "101004141848",
            "No"
          ],
          [
            "101004113313",
            "No"
          ],
          [
            "101004113751",
            "Yes"
          ],
          [
            "101004113902",
            "Yes"
          ],
          [
            "101004113473",
            "No"
          ],
          [
            "101004113604",
            "No"
          ],
          [
            "101004114154",
            "Yes"
          ],
          [
            "101004114383",
            "No"
          ],
          [
            "101004114795",
            "Yes"
          ],
          [
            "101004118346",
            "Yes"
          ],
          [
            "101004115302",
            "No"
          ],
          [
            "101004115066",
            "No"
          ]
        ]
      },
      "tags": [
        "case-sensitivity"
      ]
    },
    {
      "name": "sqlp_boston311_case_expression_streaming",
      "description": "Sqlp Boston311 Case Expression Streaming",
      "command": "qsv sqlp \"&test_file\" \"\n            r#\\\"SELECT case_enquiry_id, \n           CASE closed_dt is null and case_title ~* 'graffiti' \n              WHEN True THEN 'Yes' \n              WHEN False THEN 'No' \n              ELSE 'N/A'\n           END as graffiti_related\n           from _t_1\n           where case_status = 'Open'\\\"#,\n        \"",
      "args": [
        "&test_file",
        "\n            r#\"SELECT case_enquiry_id, \n           CASE closed_dt is null and case_title ~* 'graffiti' \n              WHEN True THEN 'Yes' \n              WHEN False THEN 'No' \n              ELSE 'N/A'\n           END as graffiti_related\n           from _t_1\n           where case_status = 'Open'\"#,\n        "
      ],
      "options": {
        "--streaming": "true"
      },
      "expected": {
        "data": [
          [
            "case_enquiry_id",
            "graffiti_related"
          ],
          [
            "101004143000",
            "No"
          ],
          [
            "101004155594",
            "No"
          ],
          [
            "101004154423",
            "No"
          ],
          [
            "101004141848",
            "No"
          ],
          [
            "101004113313",
            "No"
          ],
          [
            "101004113751",
            "Yes"
          ],
          [
            "101004113902",
            "Yes"
          ],
          [
            "101004113473",
            "No"
          ],
          [
            "101004113604",
            "No"
          ],
          [
            "101004114154",
            "Yes"
          ],
          [
            "101004114383",
            "No"
          ],
          [
            "101004114795",
            "Yes"
          ],
          [
            "101004118346",
            "Yes"
          ],
          [
            "101004115302",
            "No"
          ],
          [
            "101004115066",
            "No"
          ]
        ]
      },
      "tags": [
        "case-sensitivity"
      ]
    },
    {
      "name": "sqlp_boston311_case",
      "description": "Sqlp Boston311 Case",
      "command": "qsv sqlp \"&test_file\" \"\n        r#\\\"SELECT case_enquiry_id, \n           CASE \n              WHEN case_title ~* 'graffiti' THEN 'Graffitti' \n              WHEN case_title ~* 'vehicle' THEN 'Vehicle'\n              WHEN case_title ~* 'sidewalk' THEN 'Sidewalk'\n              ELSE 'Something else'\n           END as topic\n           from _t_1\n           where case_status = 'Open'\\\"#,\n    \"",
      "args": [
        "&test_file",
        "\n        r#\"SELECT case_enquiry_id, \n           CASE \n              WHEN case_title ~* 'graffiti' THEN 'Graffitti' \n              WHEN case_title ~* 'vehicle' THEN 'Vehicle'\n              WHEN case_title ~* 'sidewalk' THEN 'Sidewalk'\n              ELSE 'Something else'\n           END as topic\n           from _t_1\n           where case_status = 'Open'\"#,\n    "
      ],
      "expected": {
        "data": [
          [
            "case_enquiry_id",
            "topic"
          ],
          [
            "101004143000",
            "Something else"
          ],
          [
            "101004155594",
            "Something else"
          ],
          [
            "101004154423",
            "Sidewalk"
          ],
          [
            "101004141848",
            "Something else"
          ],
          [
            "101004113313",
            "Something else"
          ],
          [
            "101004113751",
            "Graffitti"
          ],
          [
            "101004113902",
            "Graffitti"
          ],
          [
            "101004113473",
            "Sidewalk"
          ],
          [
            "101004113604",
            "Something else"
          ],
          [
            "101004114154",
            "Graffitti"
          ],
          [
            "101004114383",
            "Something else"
          ],
          [
            "101004114795",
            "Graffitti"
          ],
          [
            "101004118346",
            "Graffitti"
          ],
          [
            "101004115302",
            "Vehicle"
          ],
          [
            "101004115066",
            "Sidewalk"
          ]
        ]
      },
      "tags": [
        "case-sensitivity"
      ]
    },
    {
      "name": "sqlp_boston311_case_zstd",
      "description": "Sqlp Boston311 Case Zstd",
      "command": "qsv sqlp \"&test_file\" \"\n        r#\\\"SELECT case_enquiry_id, \n           CASE \n              WHEN case_title ~* 'graffiti' THEN 'Graffitti' \n              WHEN case_title ~* 'vehicle' THEN 'Vehicle'\n              WHEN case_title ~* 'sidewalk' THEN 'Sidewalk'\n              ELSE 'Something else'\n           END as topic\n           from read_csv('boston311-100.csv.zst'\"",
      "args": [
        "&test_file",
        "\n        r#\"SELECT case_enquiry_id, \n           CASE \n              WHEN case_title ~* 'graffiti' THEN 'Graffitti' \n              WHEN case_title ~* 'vehicle' THEN 'Vehicle'\n              WHEN case_title ~* 'sidewalk' THEN 'Sidewalk'\n              ELSE 'Something else'\n           END as topic\n           from read_csv('boston311-100.csv.zst'"
      ],
      "expected": {
        "data": [
          [
            "case_enquiry_id",
            "topic"
          ],
          [
            "101004143000",
            "Something else"
          ],
          [
            "101004155594",
            "Something else"
          ],
          [
            "101004154423",
            "Sidewalk"
          ],
          [
            "101004141848",
            "Something else"
          ],
          [
            "101004113313",
            "Something else"
          ],
          [
            "101004113751",
            "Graffitti"
          ],
          [
            "101004113902",
            "Graffitti"
          ],
          [
            "101004113473",
            "Sidewalk"
          ],
          [
            "101004113604",
            "Something else"
          ],
          [
            "101004114154",
            "Graffitti"
          ],
          [
            "101004114383",
            "Something else"
          ],
          [
            "101004114795",
            "Graffitti"
          ],
          [
            "101004118346",
            "Graffitti"
          ],
          [
            "101004115302",
            "Vehicle"
          ],
          [
            "101004115066",
            "Sidewalk"
          ]
        ]
      },
      "tags": [
        "case-sensitivity"
      ]
    },
    {
      "name": "sqlp_literal_pattern_match",
      "description": "Sqlp Literal Pattern Match",
      "input": {
        "data": [
          [
            "idx",
            "val"
          ],
          [
            "0",
            "ABC"
          ],
          [
            "1",
            "abc"
          ],
          [
            "2",
            "000"
          ],
          [
            "3",
            "A0C"
          ],
          [
            "4",
            "a0c"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"r#\\\"SELECT * FROM test WHERE val NOT REGEXP '.*c$'\\\"#\"",
      "args": [
        "test.csv",
        "r#\"SELECT * FROM test WHERE val NOT REGEXP '.*c$'\"#"
      ],
      "expected": {
        "data": [
          [
            "idx",
            "val"
          ],
          [
            "0",
            "ABC"
          ],
          [
            "2",
            "000"
          ],
          [
            "3",
            "A0C"
          ]
        ]
      }
    },
    {
      "name": "sqlp_expression_pattern_match",
      "description": "Sqlp Expression Pattern Match",
      "command": "qsv sqlp test.csv \"SELECT idx, val FROM test WHERE val REGEXP pat\"",
      "args": [
        "test.csv",
        "SELECT idx, val FROM test WHERE val REGEXP pat"
      ],
      "expected": {
        "data": [
          [
            "idx",
            "val"
          ],
          [
            "0",
            "ABC"
          ],
          [
            "3",
            "A0C"
          ]
        ]
      }
    },
    {
      "name": "sqlp_sql_join_on_subquery",
      "description": "Sqlp Sql Join On Subquery",
      "input": {
        "data": [
          [
            "idx",
            "val"
          ],
          [
            "0",
            "ABC"
          ],
          [
            "1",
            "abc"
          ],
          [
            "2",
            "000"
          ],
          [
            "3",
            "A0C"
          ],
          [
            "4",
            "a0c"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv test2.csv \"\n        \\\"SELECT * FROM test t1 JOIN (SELECT idx, val FROM test2 WHERE idx > 2\"",
      "args": [
        "test.csv",
        "test2.csv",
        "\n        \"SELECT * FROM test t1 JOIN (SELECT idx, val FROM test2 WHERE idx > 2"
      ],
      "expected": {
        "data": [
          [
            "idx",
            "val",
            "idx:t2",
            "val:t2"
          ],
          [
            "3",
            "A0C",
            "3",
            "A0C"
          ],
          [
            "4",
            "a0c",
            "4",
            "a0c"
          ]
        ]
      }
    },
    {
      "name": "sqlp_sql_join_on_literal_string_comparison",
      "description": "Sqlp Sql Join On Literal String Comparison",
      "input": {
        "data": [
          [
            "name",
            "role"
          ],
          [
            "alice",
            "admin"
          ],
          [
            "bob",
            "user"
          ],
          [
            "adam",
            "admin"
          ],
          [
            "charlie",
            "user"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv test2.csv \"\n        \\\"SELECT t1.name, t1.role, t2.dept FROM test t1 INNER JOIN test2 t2 ON t1.name = t2.name \\\\\n         AND t1.role = 'admin' ORDER BY t1.name\\\",\n    \"",
      "args": [
        "test.csv",
        "test2.csv",
        "\n        \"SELECT t1.name, t1.role, t2.dept FROM test t1 INNER JOIN test2 t2 ON t1.name = t2.name \\\n         AND t1.role = 'admin' ORDER BY t1.name\",\n    "
      ],
      "expected": {
        "data": [
          [
            "name",
            "role",
            "dept"
          ],
          [
            "adam",
            "admin",
            "SEC"
          ],
          [
            "alice",
            "admin",
            "IT"
          ]
        ]
      }
    },
    {
      "name": "sqlp_sql_join_on_expression_comparison",
      "description": "Sqlp Sql Join On Expression Comparison",
      "input": {
        "data": [
          [
            "code",
            "value"
          ],
          [
            "HELLO",
            "100"
          ],
          [
            "WORLD",
            "200"
          ],
          [
            "FOO",
            "300"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv test2.csv \"\n            \\\"SELECT t1.code AS code1, t2.code AS code2, (t1.value * t2.value\"",
      "args": [
        "test.csv",
        "test2.csv",
        "\n            \"SELECT t1.code AS code1, t2.code AS code2, (t1.value * t2.value"
      ],
      "expected": {
        "data": [
          [
            "code1",
            "code2",
            "VAL"
          ],
          [
            "HELLO",
            "hello",
            "-123.45"
          ],
          [
            "WORLD",
            "world",
            "913.56"
          ]
        ]
      }
    },
    {
      "name": "sqlp_sql_from_subquery",
      "description": "Sqlp Sql From Subquery",
      "input": {
        "data": [
          [
            "idx",
            "val"
          ],
          [
            "0",
            "ABC"
          ],
          [
            "1",
            "abc"
          ],
          [
            "2",
            "000"
          ],
          [
            "3",
            "A0C"
          ],
          [
            "4",
            "a0c"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv test2.csv \"\n        \\\"SELECT * FROM (SELECT idx, val FROM test WHERE idx > 2\"",
      "args": [
        "test.csv",
        "test2.csv",
        "\n        \"SELECT * FROM (SELECT idx, val FROM test WHERE idx > 2"
      ],
      "expected": {
        "data": [
          [
            "idx",
            "val",
            "idx:t2",
            "val:t2"
          ],
          [
            "3",
            "A0C",
            "3",
            "A0C"
          ],
          [
            "4",
            "a0c",
            "4",
            "a0c"
          ]
        ]
      }
    },
    {
      "name": "sqlp_sql_tsv",
      "description": "Sqlp Sql Tsv",
      "input": {
        "data": [
          [
            "idx",
            "val"
          ],
          [
            "0",
            "ABC"
          ],
          [
            "1",
            "abc"
          ],
          [
            "2",
            "000"
          ],
          [
            "3",
            "A0C"
          ],
          [
            "4",
            "a0c"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"SELECT * FROM test\"",
      "args": [
        "test.csv",
        "SELECT * FROM test"
      ]
    },
    {
      "name": "sqlp_sql_ssv",
      "description": "Sqlp Sql Ssv",
      "input": {
        "data": [
          [
            "idx",
            "val"
          ],
          [
            "0",
            "ABC"
          ],
          [
            "1",
            "abc"
          ],
          [
            "2",
            "000"
          ],
          [
            "3",
            "A0C"
          ],
          [
            "4",
            "a0c"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"SELECT * FROM test\"",
      "args": [
        "test.csv",
        "SELECT * FROM test"
      ]
    },
    {
      "name": "sqlp_sql_ssv_output",
      "description": "Sqlp Sql Ssv Output",
      "command": "qsv sqlp test.ssv \"SELECT * FROM test\"",
      "args": [
        "test.ssv",
        "SELECT * FROM test"
      ]
    },
    {
      "name": "sqlp_issue2014",
      "description": "Sqlp Issue2014",
      "command": "qsv sqlp test.ssv \"SELECT * FROM test\" decompress \"output_file.clone(\" \"output_file.clone(\" output_file",
      "args": [
        "test.ssv",
        "SELECT * FROM test",
        "decompress",
        "output_file.clone(",
        "output_file.clone(",
        "output_file"
      ],
      "expected": {
        "data": [
          [
            "id",
            "item",
            "price"
          ],
          [
            "0",
            "wallet",
            "9.99"
          ],
          [
            "1",
            "comb",
            "1.39"
          ],
          [
            "2",
            "pencil",
            "0.49"
          ]
        ]
      }
    },
    {
      "name": "sqlp_binary_functions",
      "description": "Sqlp Binary Functions",
      "input": {
        "data": [
          [
            "dummy"
          ],
          [
            "0"
          ]
        ],
        "filename": "dummy.csv"
      },
      "command": "qsv sqlp dummy.csv \"\n            r#\\\"\n        SELECT *,\n          -- bit strings\n          b''                 AS b0,\n          b'1001'             AS b1,\n          b'11101011'         AS b2,\n          b'1111110100110010' AS b3,\n          -- hex strings\n          x''                 AS x0,\n          x'FF'               AS x1,\n          x'4142'             AS x2,\n          x'DeadBeef'         AS x3,\n        FROM dummy\n        \\\"#,\n        \"",
      "args": [
        "dummy.csv",
        "\n            r#\"\n        SELECT *,\n          -- bit strings\n          b''                 AS b0,\n          b'1001'             AS b1,\n          b'11101011'         AS b2,\n          b'1111110100110010' AS b3,\n          -- hex strings\n          x''                 AS x0,\n          x'FF'               AS x1,\n          x'4142'             AS x2,\n          x'DeadBeef'         AS x3,\n        FROM dummy\n        \"#,\n        "
      ]
    },
    {
      "name": "sqlp_length_fns",
      "description": "Sqlp Length Fns",
      "input": {
        "data": [
          [
            "words"
          ],
          [
            "Cafe"
          ],
          [
            ""
          ],
          [
            "東京"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n              words,\n              LENGTH(words\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n              words,\n              LENGTH(words"
      ]
    },
    {
      "name": "sqlp_length_fns_rnull_set_to_null",
      "description": "Sqlp Length Fns Rnull Set To Null",
      "input": {
        "data": [
          [
            "words"
          ],
          [
            "Cafe"
          ],
          [
            ""
          ],
          [
            "東京"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n            r#\\\"\n        SELECT\n              words,\n              LENGTH(words\"",
      "args": [
        "test.csv",
        "\n            r#\"\n        SELECT\n              words,\n              LENGTH(words"
      ]
    },
    {
      "name": "sqlp_control_flow",
      "description": "Sqlp Control Flow",
      "input": {
        "data": [
          [
            "x",
            "y",
            "z"
          ],
          [
            "1",
            "5",
            "3"
          ],
          [
            "",
            "4",
            "4"
          ],
          [
            "2",
            "",
            ""
          ],
          [
            "3",
            "3",
            "3"
          ],
          [
            "",
            "",
            "6"
          ],
          [
            "4",
            "2",
            ""
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n          COALESCE(x,y,z\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n          COALESCE(x,y,z"
      ],
      "expected": {
        "data": [
          [
            "coalsc",
            "nullif x_y",
            "nullif y_z",
            "ifnull x_y",
            "inullf y_z",
            "both",
            "x_eq_y"
          ],
          [
            "1",
            "1",
            "5",
            "1",
            "5",
            "1",
            "ne"
          ],
          [
            "4",
            "",
            "",
            "4",
            "4",
            "",
            "ne"
          ],
          [
            "2",
            "2",
            "",
            "2",
            "-1",
            "2",
            "ne"
          ],
          [
            "3",
            "",
            "",
            "3",
            "3",
            "3",
            "eq"
          ],
          [
            "6",
            "",
            "",
            "",
            "-1",
            "",
            "ne"
          ],
          [
            "4",
            "4",
            "2",
            "4",
            "2",
            "4",
            "ne"
          ]
        ]
      }
    },
    {
      "name": "sqlp_div_sign",
      "description": "Sqlp Div Sign",
      "input": {
        "data": [
          [
            "a",
            "b"
          ],
          [
            "10.0",
            "-100.5"
          ],
          [
            "20.0",
            "7.0"
          ],
          [
            "30.0",
            "2.5"
          ],
          [
            "40.0",
            ""
          ],
          [
            "50.0",
            "-3.14"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n            a / b AS a_div_b,\n            a // b AS a_floordiv_b,\n            SIGN(b\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n            a / b AS a_div_b,\n            a // b AS a_floordiv_b,\n            SIGN(b"
      ],
      "expected": {
        "data": [
          [
            "a_div_b",
            "a_floordiv_b",
            "b_sign"
          ],
          [
            "-0.09950248756218906",
            "-1",
            "-1.0"
          ],
          [
            "2.857142857142857",
            "2",
            "1.0"
          ],
          [
            "12.0",
            "12",
            "1.0"
          ],
          [
            "",
            "",
            ""
          ],
          [
            "-15.92356687898089",
            "-16",
            "-1.0"
          ]
        ]
      }
    },
    {
      "name": "sqlp_string_replace",
      "description": "Sqlp String Replace",
      "input": {
        "data": [
          [
            "words"
          ],
          [
            "Yemeni coffee is the best coffee"
          ],
          [
            ""
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n            r#\\\"\n        SELECT\n        REPLACE(\n          REPLACE(words, 'coffee', 'tea'\"",
      "args": [
        "test.csv",
        "\n            r#\"\n        SELECT\n        REPLACE(\n          REPLACE(words, 'coffee', 'tea'"
      ],
      "expected": {
        "data": [
          [
            "words"
          ],
          [
            "English breakfast tea is the best tea"
          ],
          [
            ""
          ]
        ]
      }
    },
    {
      "name": "sqlp_compound_join_basic",
      "description": "Sqlp Compound Join Basic",
      "input": {
        "data": [
          [
            "a",
            "b"
          ],
          [
            "1",
            "1"
          ],
          [
            "2",
            "3"
          ],
          [
            "3",
            "4"
          ],
          [
            "4",
            "4"
          ],
          [
            "5",
            "5"
          ]
        ],
        "filename": "test1.csv"
      },
      "command": "qsv sqlp \"\n            r#\\\"\n        SELECT * FROM test1\n         INNER JOIN test2 ON test1.a = test2.a AND test1.b = test2.b\n\\\"#,\n        \"",
      "args": [
        "\n            r#\"\n        SELECT * FROM test1\n         INNER JOIN test2 ON test1.a = test2.a AND test1.b = test2.b\n\"#,\n        "
      ],
      "options": {
        "--truncate-ragged-lines": "true"
      },
      "expected": {
        "data": [
          [
            "a",
            "b",
            "a:test2",
            "b:test2"
          ],
          [
            "2",
            "3",
            "2",
            "3"
          ],
          [
            "3",
            "4",
            "3",
            "4"
          ]
        ]
      },
      "tags": [
        "basic"
      ]
    },
    {
      "name": "sqlp_compound_join_diff_colnames",
      "description": "Sqlp Compound Join Diff Colnames",
      "input": {
        "data": [
          [
            "a",
            "b"
          ],
          [
            "1",
            "1"
          ],
          [
            "2",
            "2"
          ],
          [
            "3",
            "3"
          ],
          [
            "4",
            "4"
          ],
          [
            "5",
            "5"
          ]
        ],
        "filename": "test1.csv"
      },
      "command": "qsv sqlp \"\n            r#\\\"\n        SELECT * FROM test1\n         INNER JOIN test2 ON test1.a = test2.b AND test1.b = test2.a\n\\\"#,\n        \"",
      "args": [
        "\n            r#\"\n        SELECT * FROM test1\n         INNER JOIN test2 ON test1.a = test2.b AND test1.b = test2.a\n\"#,\n        "
      ],
      "options": {
        "--truncate-ragged-lines": "true"
      },
      "expected": {
        "data": [
          [
            "a",
            "b",
            "a:test2",
            "b:test2",
            "c"
          ],
          [
            "2",
            "2",
            "2",
            "2",
            "8"
          ],
          [
            "3",
            "3",
            "3",
            "3",
            "9"
          ]
        ]
      }
    },
    {
      "name": "sqlp_compound_join_three_tables",
      "description": "Sqlp Compound Join Three Tables",
      "input": {
        "data": [
          [
            "a",
            "b"
          ],
          [
            "1",
            "1"
          ],
          [
            "2",
            "3"
          ],
          [
            "3",
            "4"
          ],
          [
            "4",
            "4"
          ],
          [
            "5",
            "5"
          ]
        ],
        "filename": "test1.csv"
      },
      "command": "qsv sqlp \"\n            r#\\\"\n            SELECT * FROM test1\n            INNER JOIN test2\n                ON test1.a = test2.a AND test1.b = test2.b\n            INNER JOIN test3\n                ON test1.a = test3.a AND test1.b = test3.b\n\\\"#,\n        \"",
      "args": [
        "\n            r#\"\n            SELECT * FROM test1\n            INNER JOIN test2\n                ON test1.a = test2.a AND test1.b = test2.b\n            INNER JOIN test3\n                ON test1.a = test3.a AND test1.b = test3.b\n\"#,\n        "
      ],
      "options": {
        "--truncate-ragged-lines": "true"
      },
      "expected": {
        "data": [
          [
            "a",
            "b",
            "a:test2",
            "b:test2",
            "a:test3",
            "b:test3",
            "c"
          ],
          [
            "2",
            "3",
            "2",
            "3",
            "2",
            "3",
            "3"
          ],
          [
            "3",
            "4",
            "3",
            "4",
            "3",
            "4",
            "4"
          ]
        ]
      }
    },
    {
      "name": "sqlp_string_concat",
      "description": "Sqlp String Concat",
      "input": {
        "data": [
          [
            "x",
            "y",
            "z"
          ],
          [
            "a",
            "d",
            "1"
          ],
          [
            "",
            "e",
            "2"
          ],
          [
            "c",
            "f",
            "3"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n           (\\\"x\\\" || \\\"x\\\" || \\\"y\\\"\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n           (\"x\" || \"x\" || \"y\""
      ],
      "expected": {
        "data": [
          [
            "c0",
            "c1",
            "c2",
            "c3",
            "c4",
            "c5",
            "c6"
          ],
          [
            "aad",
            "ad1",
            "aad",
            "aad",
            "ad2",
            "a:d:1",
            "a!d!1"
          ],
          [
            "",
            "",
            "e",
            "e",
            "e4",
            "e:2",
            "e!2"
          ],
          [
            "ccf",
            "cf3",
            "ccf",
            "ccf",
            "cf6",
            "c:f:3",
            "c!f!3"
          ]
        ]
      }
    },
    {
      "name": "sqlp_string_right_reverse",
      "description": "Sqlp String Right Reverse",
      "input": {
        "data": [
          [
            "txt"
          ],
          [
            "abcde"
          ],
          [
            "abc"
          ],
          [
            "a"
          ],
          [
            ""
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n           LEFT(txt,2\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n           LEFT(txt,2"
      ],
      "expected": {
        "data": [
          [
            "l",
            "r",
            "rev"
          ],
          [
            "ab",
            "de",
            "edcba"
          ],
          [
            "ab",
            "bc",
            "cba"
          ],
          [
            "a",
            "a",
            "a"
          ],
          [
            "",
            "",
            ""
          ]
        ]
      }
    },
    {
      "name": "sqlp_modulo",
      "description": "Sqlp Modulo",
      "input": {
        "data": [
          [
            "a",
            "b",
            "c",
            "d"
          ],
          [
            "1.5",
            "6",
            "11",
            "16.5"
          ],
          [
            "",
            "7",
            "12",
            "17.0"
          ],
          [
            "3.0",
            "8",
            "13",
            "18.5"
          ],
          [
            "4333333333",
            "9",
            "14",
            ""
          ],
          [
            "5.0",
            "10",
            "15",
            "20.0"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n            cast(a as float\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n            cast(a as float"
      ],
      "expected": {
        "data": [
          [
            "a2",
            "b3",
            "c4",
            "d55"
          ],
          [
            "1.5",
            "0.0",
            "3.0",
            "0.0"
          ],
          [
            "",
            "1.0",
            "0.0",
            "0.5"
          ],
          [
            "1.0",
            "2.0",
            "1.0",
            "2.0"
          ],
          [
            "1.0",
            "0.0",
            "2.0",
            ""
          ],
          [
            "1.0",
            "1.0",
            "3.0",
            "3.5"
          ]
        ]
      }
    },
    {
      "name": "sqlp_try_cast",
      "description": "Sqlp Try Cast",
      "input": {
        "data": [
          [
            "foo",
            "bar"
          ],
          [
            "65432",
            "1999-12-31"
          ],
          [
            "101010",
            "N/A"
          ],
          [
            "-3333",
            "2024-01-01"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n            try_cast(foo as uint2\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n            try_cast(foo as uint2"
      ],
      "expected": {
        "data": [
          [
            "foo",
            "bar"
          ],
          [
            "65432",
            "1999-12-31"
          ],
          [
            "",
            ""
          ],
          [
            "",
            "2024-01-01"
          ]
        ]
      }
    },
    {
      "name": "sqlp_stddev_variance",
      "description": "Sqlp Stddev Variance",
      "input": {
        "data": [
          [
            "v1",
            "v2",
            "v3",
            "v4"
          ],
          [
            "-1.0",
            "5.5",
            "-10",
            "-100"
          ],
          [
            "0.0",
            "0.0",
            "",
            "0.0"
          ],
          [
            "1.0",
            "3.0",
            "10",
            "-50.0"
          ]
        ],
        "filename": "test.csv"
      },
      "command": "qsv sqlp test.csv \"\n        r#\\\"\n        SELECT\n            STDEV(v1\"",
      "args": [
        "test.csv",
        "\n        r#\"\n        SELECT\n            STDEV(v1"
      ],
      "expected": {
        "data": [
          [
            "v1_std",
            "v2_std",
            "v3_std",
            "v4_std",
            "v1_var",
            "v2_var",
            "v3_var",
            "v4_var"
          ],
          [
            "1.0",
            "2.753785273643051",
            "14.142135623730951",
            "50.0",
            "1.0",
            "7.583333333333334",
            "200.0",
            "2500.0"
          ]
        ]
      }
    },
    {
      "name": "sqlp_string_position",
      "description": "Sqlp String Position",
      "input": {
        "data": [
          [
            "city"
          ],
          [
            "Dubai"
          ],
          [
            "Abu Dhabi"
          ],
          [
            "Sharjah"
          ],
          [
            "Al Ain"
          ],
          [
            "Ajman"
          ],
          [
            "Ras Al Khaimah"
          ]
        ],
        "filename": "cities.csv"
      },
      "command": "qsv sqlp cities.csv \"\n        r#\\\"\n        SELECT\n        POSITION('a' IN city\"",
      "args": [
        "cities.csv",
        "\n        r#\"\n        SELECT\n        POSITION('a' IN city"
      ],
      "expected": {
        "data": [
          [
            "a_lc1",
            "a_uc1",
            "a_lc2",
            "a_uc2"
          ],
          [
            "4",
            "0",
            "4",
            "0"
          ],
          [
            "7",
            "1",
            "7",
            "1"
          ],
          [
            "3",
            "0",
            "3",
            "0"
          ],
          [
            "0",
            "1",
            "0",
            "1"
          ],
          [
            "4",
            "1",
            "4",
            "1"
          ],
          [
            "2",
            "5",
            "2",
            "5"
          ]
        ]
      }
    },
    {
      "name": "sqlp_date_part",
      "description": "Sqlp Date Part",
      "input": {
        "data": [
          [
            "datecol"
          ],
          [
            "20-01-2012 10:30:20"
          ]
        ],
        "filename": "datestbl.csv"
      },
      "command": "qsv sqlp datestbl.csv \"\n            r#\\\"\n        SELECT \n            DATE_PART('isoyear', datecol\"",
      "args": [
        "datestbl.csv",
        "\n            r#\"\n        SELECT \n            DATE_PART('isoyear', datecol"
      ],
      "options": {
        "--try-parsedates": "true"
      },
      "expected": {
        "data": [
          [
            "c1",
            "c2",
            "c3",
            "c4",
            "c5",
            "c6",
            "c61",
            "c62",
            "c63",
            "c7",
            "c8",
            "c9",
            "c10",
            "c11",
            "c12",
            "c13",
            "c14"
          ],
          [
            "2012",
            "1",
            "20",
            "10",
            "30",
            "20",
            "20000.0",
            "20000000.0",
            "20000000000.0",
            "3",
            "20",
            "5",
            "10:30:20.000000000",
            "201",
            "21",
            "3",
            "1"
          ]
        ]
      }
    },
    {
      "name": "sqlp_date_part_tz",
      "description": "Sqlp Date Part Tz",
      "input": {
        "data": [
          [
            "datecol"
          ],
          [
            "2012-01-20T10:30:20-05:00"
          ],
          [
            "2012-11-05T10:30:20.1234Z"
          ],
          [
            "1999-03-15T15:30:20.1234+01:00"
          ],
          [
            "1978-08-05T23:30:20.1234-01:00"
          ]
        ],
        "filename": "datestbl.csv"
      },
      "command": "qsv sqlp datestbl.csv \"\n            r#\\\"\n        SELECT\n            DATE_PART('isoyear', datecol\"",
      "args": [
        "datestbl.csv",
        "\n            r#\"\n        SELECT\n            DATE_PART('isoyear', datecol"
      ],
      "options": {
        "--try-parsedates": "true"
      },
      "expected": {
        "data": [
          [
            "c1",
            "c2",
            "c3",
            "c4",
            "c5",
            "c6",
            "c61",
            "c62",
            "c63",
            "c7",
            "c8",
            "c9",
            "c10",
            "c11",
            "c12",
            "c13",
            "c14",
            "c15",
            "c16"
          ],
          [
            "2012",
            "1",
            "20",
            "15",
            "30",
            "20",
            "20000.0",
            "20000000.0",
            "20000000000.0",
            "3",
            "20",
            "5",
            "15:30:20.000000000",
            "201",
            "21",
            "3",
            "1",
            "0",
            "1327073420.0"
          ],
          [
            "2012",
            "11",
            "5",
            "10",
            "30",
            "20",
            "20123.4",
            "20123400.0",
            "20123400000.0",
            "45",
            "310",
            "1",
            "10:30:20.123400000",
            "201",
            "21",
            "3",
            "4",
            "0",
            "1352111420.1234"
          ],
          [
            "1999",
            "3",
            "15",
            "14",
            "30",
            "20",
            "20123.4",
            "20123400.0",
            "20123400000.0",
            "11",
            "74",
            "1",
            "14:30:20.123400000",
            "199",
            "20",
            "2",
            "1",
            "0",
            "921508220.1234"
          ],
          [
            "1978",
            "8",
            "6",
            "0",
            "30",
            "20",
            "20123.4",
            "20123400.0",
            "20123400000.0",
            "31",
            "218",
            "0",
            "00:30:20.123400000",
            "197",
            "20",
            "2",
            "3",
            "0",
            "271211420.1234"
          ]
        ]
      }
    },
    {
      "name": "sqlp_date",
      "description": "Sqlp Date",
      "command": "qsv sqlp SKIP_INPUT \"\n        r#\\\"\n        SELECT \n            DATE('2021-03-15'\"",
      "args": [
        "SKIP_INPUT",
        "\n        r#\"\n        SELECT \n            DATE('2021-03-15'"
      ],
      "expected": {
        "data": [
          [
            "c1",
            "c2",
            "c3"
          ],
          [
            "2021-03-15",
            "2021-03-15",
            "2021-03-15"
          ]
        ]
      }
    },
    {
      "name": "sqlp_date_strftime",
      "description": "Sqlp Date Strftime",
      "input": {
        "data": [
          [
            "dtm",
            "dt",
            "tm"
          ],
          [
            "1972-03-06 23:50:03",
            "1978-07-05",
            "10:10:10"
          ],
          [
            "1980-09-30 01:25:50",
            "1969-12-31",
            "22:33:55"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            r#\\\"\n        SELECT\n      STRFTIME(dtm,'%m.%d.%Y/%T'\"",
      "args": [
        "data.csv",
        "\n            r#\"\n        SELECT\n      STRFTIME(dtm,'%m.%d.%Y/%T'"
      ],
      "options": {
        "--try-parsedates": "true"
      },
      "expected": {
        "data": [
          [
            "s_dtm",
            "s_dt",
            "s_tm"
          ],
          [
            "03.06.1972/23:50:03",
            "July 05",
            "1978",
            "10.10.10"
          ],
          [
            "09.30.1980/01:25:50",
            "December 31",
            "1969",
            "55.33.22"
          ]
        ]
      }
    },
    {
      "name": "sqlp_read_jsonl",
      "description": "Sqlp Read Jsonl",
      "command": "qsv sqlp SKIP_INPUT",
      "args": [
        "SKIP_INPUT"
      ]
    },
    {
      "name": "sqlp_string_like_ops",
      "description": "Sqlp String Like Ops",
      "input": {
        "data": [
          [
            "x",
            "y"
          ],
          [
            "aaa",
            "abc"
          ],
          [
            "bbb",
            "b"
          ],
          [
            "a",
            "aa"
          ]
        ],
        "filename": "likedata.csv"
      },
      "command": "qsv sqlp likedata.csv \"\n        r#\\\"\n        SELECT\n            x,\n            x ^@ 'a' AS x_starts_with_a,\n            x ~~* '%B' AS x_ends_with_b_case_insensitive,\n            x ^@ y AS x_starts_with_y,\n            x ~~ '%a' AS x_ends_with_a\n        FROM likedata\\\"#,\n    \"",
      "args": [
        "likedata.csv",
        "\n        r#\"\n        SELECT\n            x,\n            x ^@ 'a' AS x_starts_with_a,\n            x ~~* '%B' AS x_ends_with_b_case_insensitive,\n            x ^@ y AS x_starts_with_y,\n            x ~~ '%a' AS x_ends_with_a\n        FROM likedata\"#,\n    "
      ],
      "expected": {
        "data": [
          [
            "x",
            "x_starts_with_a",
            "x_ends_with_b_case_insensitive",
            "x_starts_with_y",
            "x_ends_with_a"
          ],
          [
            "aaa",
            "true",
            "false",
            "false",
            "true"
          ],
          [
            "bbb",
            "false",
            "true",
            "true",
            "false"
          ],
          [
            "a",
            "true",
            "false",
            "false",
            "true"
          ]
        ]
      }
    },
    {
      "name": "sqlp_natural_join",
      "description": "Sqlp Natural Join",
      "input": {
        "data": [
          [
            "CharacterID",
            "FirstName",
            "LastName"
          ],
          [
            "1",
            "Jerna Morat",
            "Gurgeh"
          ],
          [
            "2",
            "Cheradenine",
            "Zakalwe"
          ],
          [
            "3",
            "Byr",
            "Genar-Hofoen"
          ]
        ],
        "filename": "data1.csv"
      },
      "command": "qsv sqlp \"\n        r#\\\"SELECT COLUMNS('^[^:]+$'\"",
      "args": [
        "\n        r#\"SELECT COLUMNS('^[^:]+$'"
      ],
      "expected": {
        "data": [
          [
            "CharacterID",
            "FirstName",
            "LastName",
            "Book",
            "Ship"
          ],
          [
            "1",
            "Jerna Morat",
            "Gurgeh",
            "Player of Games",
            "Limiting Factor"
          ],
          [
            "2",
            "Cheradenine",
            "Zakalwe",
            "Use of Weapons",
            "Xenophobe"
          ],
          [
            "3",
            "Byr",
            "Genar-Hofoen",
            "Excession",
            "Grey Area"
          ]
        ]
      }
    },
    {
      "name": "sqlp_star_ilike",
      "description": "Sqlp Star Ilike",
      "input": {
        "data": [
          [
            "ID",
            "FirstName",
            "LastName",
            "Address",
            "City"
          ],
          [
            "333",
            "Bruce",
            "Wayne",
            "The Batcave",
            "Gotham"
          ],
          [
            "666",
            "Diana",
            "Prince",
            "Paradise Island",
            "Themyscira"
          ],
          [
            "999",
            "Clark",
            "Kent",
            "Fortress of Solitude",
            "Metropolis"
          ]
        ],
        "filename": "starlikedata.csv"
      },
      "command": "qsv sqlp starlikedata.csv \"\n        r#\\\"\n        SELECT * ILIKE '%a%e%'\n  FROM starlikedata\n  ORDER BY FirstName\\\"#,\n    \" starlikedata.csv \"\n        r#\\\"\n        SELECT * ILIKE '%I%' RENAME (FirstName AS Name\" starlikedata.csv \"\n        r#\\\"\n        SELECT * EXCLUDE (ID, City, LastName\"",
      "args": [
        "starlikedata.csv",
        "\n        r#\"\n        SELECT * ILIKE '%a%e%'\n  FROM starlikedata\n  ORDER BY FirstName\"#,\n    ",
        "starlikedata.csv",
        "\n        r#\"\n        SELECT * ILIKE '%I%' RENAME (FirstName AS Name",
        "starlikedata.csv",
        "\n        r#\"\n        SELECT * EXCLUDE (ID, City, LastName"
      ],
      "expected": {
        "data": [
          [
            "FirstName",
            "LastName",
            "Address"
          ],
          [
            "Bruce",
            "Wayne",
            "The Batcave"
          ],
          [
            "Clark",
            "Kent",
            "Fortress of Solitude"
          ],
          [
            "Diana",
            "Prince",
            "Paradise Island"
          ]
        ]
      }
    },
    {
      "name": "sqlp_skip_input",
      "description": "Sqlp Skip Input",
      "command": "qsv sqlp SKIP_INPUT \"SELECT 1 AS one, '2' AS two, 3.0 AS three\"",
      "args": [
        "SKIP_INPUT",
        "SELECT 1 AS one, '2' AS two, 3.0 AS three"
      ],
      "expected": {
        "data": [
          [
            "one",
            "two",
            "three"
          ],
          [
            "1",
            "2",
            "3.0"
          ]
        ]
      }
    },
    {
      "name": "sqlp_autotab_delim",
      "description": "Sqlp Autotab Delim",
      "command": "qsv sqlp cities_array.tsv \"\n            r#\\\"\n            SELECT \n                countryid, cities\n            FROM cities_array\n    \\\"#,\n        \"",
      "args": [
        "cities_array.tsv",
        "\n            r#\"\n            SELECT \n                countryid, cities\n            FROM cities_array\n    \"#,\n        "
      ]
    },
    {
      "name": "sqlp_dollar_quoting_string_literals",
      "description": "Sqlp Dollar Quoting String Literals",
      "input": {
        "data": [
          [
            "country_id",
            "description"
          ],
          [
            "DB",
            "Dubai"
          ],
          [
            "IN",
            "India"
          ],
          [
            "US",
            "United States"
          ],
          [
            "UK",
            "United Kingdom"
          ],
          [
            "CN",
            "China"
          ],
          [
            "RU",
            "Russia"
          ],
          [
            "NL",
            "Netherlands"
          ],
          [
            "IT",
            "Italy"
          ]
        ],
        "filename": "cities_array.csv"
      },
      "command": "qsv sqlp cities_array.csv \"\n            r#\\\"SELECT country_id, $$This is a literal $,%,',\\\"$$ AS complex_literal FROM cities_array\\\"#,\n        \"",
      "args": [
        "cities_array.csv",
        "\n            r#\"SELECT country_id, $$This is a literal $,%,',\"$$ AS complex_literal FROM cities_array\"#,\n        "
      ]
    },
    {
      "name": "sqlp_string_function_joins",
      "description": "Sqlp String Function Joins",
      "input": {
        "data": [
          [
            "id",
            "val"
          ],
          [
            "1",
            "cat"
          ],
          [
            "2",
            "dog"
          ],
          [
            "3",
            "bird"
          ],
          [
            "4",
            "fish"
          ]
        ],
        "filename": "left.csv"
      },
      "command": "qsv sqlp \"\n        \\\"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\\\n         STRPOS(r.val, l.val\" \"\n        \\\"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\\\n         STARTS_WITH(r.val, l.val\" \"\n        \\\"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\\\n         ENDS_WITH(r.val, l.val\" \"\n        \\\"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\\\n         STRPOS(l.val, r.val\"",
      "args": [
        "\n        \"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\n         STRPOS(r.val, l.val",
        "\n        \"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\n         STARTS_WITH(r.val, l.val",
        "\n        \"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\n         ENDS_WITH(r.val, l.val",
        "\n        \"SELECT l.val as left_val, r.val as right_val FROM left l CROSS JOIN right r WHERE \\\n         STRPOS(l.val, r.val"
      ],
      "expected": {
        "data": [
          [
            "left_val",
            "right_val"
          ],
          [
            "bird",
            "jailbird"
          ],
          [
            "cat",
            "catalog"
          ],
          [
            "cat",
            "category"
          ],
          [
            "dog",
            "doghouse"
          ],
          [
            "dog",
            "hotdog"
          ],
          [
            "fish",
            "starfish"
          ]
        ]
      }
    },
    {
      "name": "sqlp_string_to_array",
      "description": "Sqlp String To Array",
      "input": {
        "data": [
          [
            "id",
            "cities"
          ],
          [
            "1",
            "Dubai",
            "Abu Dhabi",
            "Sharjah"
          ],
          [
            "2",
            "Mumbai",
            "Delhi",
            "Bangalore"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            r#\\\"\n        SELECT id, STRING_TO_ARRAY(cities, ','\"",
      "args": [
        "data.csv",
        "\n            r#\"\n        SELECT id, STRING_TO_ARRAY(cities, ','"
      ]
    },
    {
      "name": "sqlp_split_part",
      "description": "Sqlp Split Part",
      "input": {
        "data": [
          [
            "s"
          ],
          [
            "xx",
            "yy",
            "zz"
          ],
          [
            "abc",
            "",
            "xyz",
            "???",
            "hmmm"
          ],
          [
            ""
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n        r#\\\"\n        SELECT\n          SPLIT_PART(s,',',1\"",
      "args": [
        "data.csv",
        "\n        r#\"\n        SELECT\n          SPLIT_PART(s,',',1"
      ],
      "expected": {
        "data": [
          [
            "s+1",
            "s+3",
            "s-2"
          ],
          [
            "xx",
            "zz",
            "yy"
          ],
          [
            "abc",
            "xyz",
            "???"
          ],
          [
            "",
            "",
            ""
          ]
        ]
      }
    },
    {
      "name": "sqlp_corr",
      "description": "Sqlp Corr",
      "input": {
        "data": [
          [
            "foo",
            "bar"
          ],
          [
            "1",
            "2"
          ],
          [
            "2",
            "4"
          ],
          [
            "3",
            "7"
          ],
          [
            "4",
            "5"
          ],
          [
            "5",
            "9"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"SELECT CORR(foo, bar) AS corr FROM data\"",
      "args": [
        "data.csv",
        "SELECT CORR(foo, bar) AS corr FROM data"
      ],
      "expected": {
        "data": [
          [
            "corr"
          ],
          [
            "0.877809"
          ]
        ]
      }
    },
    {
      "name": "sqlp_covar_pop",
      "description": "Sqlp Covar Pop",
      "input": {
        "data": [
          [
            "foo",
            "bar"
          ],
          [
            "1",
            "2"
          ],
          [
            "2",
            "4"
          ],
          [
            "3",
            "7"
          ],
          [
            "4",
            "5"
          ],
          [
            "5",
            "9"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"SELECT COVAR(foo, bar) AS covar FROM data\"",
      "args": [
        "data.csv",
        "SELECT COVAR(foo, bar) AS covar FROM data"
      ],
      "expected": {
        "data": [
          [
            "covar"
          ],
          [
            "3.75"
          ]
        ]
      }
    },
    {
      "name": "sqlp_corr_covar_covar_pop",
      "description": "Sqlp Corr Covar Covar Pop",
      "input": {
        "data": [
          [
            "foo",
            "bar"
          ],
          [
            "1",
            "2"
          ],
          [
            "2",
            "4"
          ],
          [
            "3",
            "7"
          ],
          [
            "4",
            "5"
          ],
          [
            "5",
            "9"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT CORR(foo, bar\"",
      "args": [
        "data.csv",
        "\n            \"SELECT CORR(foo, bar"
      ],
      "expected": {
        "data": [
          [
            "corr",
            "covar",
            "covar_pop"
          ],
          [
            "0.88",
            "3.75",
            "3.00"
          ]
        ]
      }
    },
    {
      "name": "sqlp_decimal_comma_validation",
      "description": "Sqlp Decimal Comma Validation",
      "command": "qsv sqlp data.csv data.csv data.csv data.csv",
      "args": [
        "data.csv",
        "data.csv",
        "data.csv",
        "data.csv"
      ],
      "options": {
        "--decimal-comma": "select * from _t_1"
      },
      "tags": [
        "custom-delimiter"
      ]
    },
    {
      "name": "sqlp_decimal_comma_validation_with_tsv_file",
      "description": "Sqlp Decimal Comma Validation With Tsv File",
      "command": "qsv sqlp data.tsv",
      "args": [
        "data.tsv"
      ],
      "options": {
        "--decimal-comma": "select * from _t_1"
      },
      "expected": {
        "data": [
          [
            "id",
            "value"
          ],
          [
            "1",
            "100",
            "5"
          ],
          [
            "2",
            "200",
            "75"
          ]
        ]
      }
    },
    {
      "name": "sqlp_decimal_comma_validation_with_ssv_file",
      "description": "Sqlp Decimal Comma Validation With Ssv File",
      "command": "qsv sqlp data.ssv",
      "args": [
        "data.ssv"
      ],
      "options": {
        "--decimal-comma": "select * from _t_1"
      }
    },
    {
      "name": "sqlp_decimal_comma_validation_with_output_file",
      "description": "Sqlp Decimal Comma Validation With Output File",
      "command": "qsv sqlp data.csv data.csv",
      "args": [
        "data.csv",
        "data.csv"
      ],
      "options": {
        "--decimal-comma": "select * from _t_1"
      },
      "tags": [
        "custom-delimiter"
      ]
    },
    {
      "name": "sqlp_decimal_comma_validation_with_tsv_output",
      "description": "Sqlp Decimal Comma Validation With Tsv Output",
      "command": "qsv sqlp data.csv",
      "args": [
        "data.csv"
      ],
      "options": {
        "--decimal-comma": "select * from _t_1"
      },
      "tags": [
        "custom-delimiter"
      ]
    },
    {
      "name": "sqlp_decimal_comma_validation_with_ssv_output",
      "description": "Sqlp Decimal Comma Validation With Ssv Output",
      "command": "qsv sqlp data.csv",
      "args": [
        "data.csv"
      ],
      "options": {
        "--decimal-comma": "select * from _t_1"
      },
      "tags": [
        "custom-delimiter"
      ]
    },
    {
      "name": "sqlp_decimal_comma_validation_with_skip_input",
      "description": "Sqlp Decimal Comma Validation With Skip Input",
      "command": "qsv sqlp SKIP_INPUT",
      "args": [
        "SKIP_INPUT"
      ],
      "options": {
        "--decimal-comma": "select * from read_csv('data.csv')"
      }
    },
    {
      "name": "sqlp_union_positional",
      "description": "Sqlp Union Positional",
      "input": {
        "data": [
          [
            "Value",
            "Tag"
          ],
          [
            "100",
            "hello"
          ],
          [
            "200",
            "foo"
          ]
        ],
        "filename": "df1.csv"
      },
      "command": "qsv sqlp \"\n        r#\\\"SELECT u.* FROM (\n            SELECT * FROM df1\n            UNION\n            SELECT * FROM df2\n        \"",
      "args": [
        "\n        r#\"SELECT u.* FROM (\n            SELECT * FROM df1\n            UNION\n            SELECT * FROM df2\n        "
      ],
      "expected": {
        "data": [
          [
            "Value",
            "Tag"
          ],
          [
            "100",
            "hello"
          ],
          [
            "200",
            "foo"
          ],
          [
            "300",
            "world"
          ],
          [
            "400",
            "bar"
          ]
        ]
      }
    },
    {
      "name": "sqlp_unnest_issue_3108_first",
      "description": "Sqlp Unnest Issue 3108 First",
      "input": {
        "data": [
          [
            "id",
            "data"
          ],
          [
            "1",
            "a",
            "b",
            "c"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"select first(id) as idf, unnest(string_to_array(data, ',')) as value from data\"",
      "args": [
        "data.csv",
        "select first(id) as idf, unnest(string_to_array(data, ',')) as value from data"
      ],
      "expected": {
        "data": [
          [
            "idf",
            "value"
          ],
          [
            "1",
            "a"
          ],
          [
            "1",
            "b"
          ],
          [
            "1",
            "c"
          ]
        ]
      },
      "tags": [
        "regression"
      ]
    },
    {
      "name": "sqlp_rank_funcs",
      "description": "Sqlp Rank Funcs",
      "input": {
        "data": [
          [
            "id",
            "category",
            "value"
          ],
          [
            "1",
            "A",
            "20"
          ],
          [
            "2",
            "A",
            "10"
          ],
          [
            "3",
            "A",
            "25"
          ],
          [
            "4",
            "B",
            "10"
          ],
          [
            "5",
            "B",
            "40"
          ],
          [
            "6",
            "B",
            "25"
          ],
          [
            "7",
            "C",
            "35"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n        r#\\\"SELECT\n            value,\n            ROW_NUMBER(\" data.csv \"\n        r#\\\"SELECT\n            value,\n            ROW_NUMBER(\" data.csv \"\n        r#\\\"SELECT\n            category,\n            value,\n            ROW_NUMBER(\"",
      "args": [
        "data.csv",
        "\n        r#\"SELECT\n            value,\n            ROW_NUMBER(",
        "data.csv",
        "\n        r#\"SELECT\n            value,\n            ROW_NUMBER(",
        "data.csv",
        "\n        r#\"SELECT\n            category,\n            value,\n            ROW_NUMBER("
      ],
      "expected": {
        "data": [
          [
            "value",
            "row_num",
            "rank",
            "dense_rank"
          ],
          [
            "10",
            "6",
            "6",
            "6"
          ],
          [
            "10",
            "7",
            "7",
            "7"
          ],
          [
            "20",
            "5",
            "5",
            "5"
          ],
          [
            "25",
            "3",
            "3",
            "3"
          ],
          [
            "25",
            "4",
            "4",
            "4"
          ],
          [
            "35",
            "2",
            "2",
            "2"
          ],
          [
            "40",
            "1",
            "1",
            "1"
          ]
        ]
      }
    },
    {
      "name": "sqlp_named_window_references",
      "description": "Sqlp Named Window References",
      "input": {
        "data": [
          [
            "id",
            "category",
            "value"
          ],
          [
            "1",
            "A",
            "20"
          ],
          [
            "2",
            "A",
            "10"
          ],
          [
            "3",
            "A",
            "30"
          ],
          [
            "4",
            "B",
            "15"
          ],
          [
            "5",
            "B",
            "50"
          ],
          [
            "6",
            "B",
            "30"
          ],
          [
            "7",
            "C",
            "35"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n        r#\\\"SELECT\n        category,\n        value,\n        SUM(value\" data.csv \"\n        r#\\\"SELECT\n        category,\n        value,\n        AVG(value\"",
      "args": [
        "data.csv",
        "\n        r#\"SELECT\n        category,\n        value,\n        SUM(value",
        "data.csv",
        "\n        r#\"SELECT\n        category,\n        value,\n        AVG(value"
      ],
      "expected": {
        "data": [
          [
            "category",
            "value",
            "w:sum",
            "w:min",
            "w:avg"
          ],
          [
            "A",
            "10",
            "10",
            "10",
            "20.0"
          ],
          [
            "A",
            "20",
            "30",
            "10",
            "20.0"
          ],
          [
            "A",
            "30",
            "60",
            "10",
            "20.0"
          ],
          [
            "B",
            "15",
            "15",
            "15",
            "31.666666666666668"
          ],
          [
            "B",
            "30",
            "45",
            "15",
            "31.666666666666668"
          ],
          [
            "B",
            "50",
            "95",
            "15",
            "31.666666666666668"
          ],
          [
            "C",
            "35",
            "35",
            "35",
            "35.0"
          ]
        ]
      }
    },
    {
      "name": "sqlp_array_to_string",
      "description": "Sqlp Array To String",
      "input": {
        "data": [
          [
            "a",
            "b"
          ],
          [
            "first",
            "1"
          ],
          [
            "first",
            "1"
          ],
          [
            "third",
            "42"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n        r#\\\"\n        SELECT b, ARRAY_TO_STRING(\\\"a\\\",', '\"",
      "args": [
        "data.csv",
        "\n        r#\"\n        SELECT b, ARRAY_TO_STRING(\"a\",', '"
      ],
      "expected": {
        "data": [
          [
            "b",
            "a2s"
          ],
          [
            "1",
            "first",
            "first"
          ],
          [
            "42",
            "third"
          ]
        ]
      }
    },
    {
      "name": "sqlp_unnest_issue_3108",
      "description": "Sqlp Unnest Issue 3108",
      "input": {
        "data": [
          [
            "id",
            "data"
          ],
          [
            "1",
            "a",
            "b",
            "c"
          ],
          [
            "2",
            ""
          ],
          [
            "3",
            "b",
            "c",
            "d"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"select id, unnest(string_to_array(data, ',')) as value from data\"",
      "args": [
        "data.csv",
        "select id, unnest(string_to_array(data, ',')) as value from data"
      ],
      "expected": {
        "data": [
          [
            "id",
            "value"
          ],
          [
            "1",
            "a"
          ],
          [
            "1",
            "b"
          ],
          [
            "1",
            "c"
          ],
          [
            "2",
            ""
          ],
          [
            "3",
            "b"
          ],
          [
            "3",
            "c"
          ],
          [
            "3",
            "d"
          ]
        ]
      },
      "tags": [
        "regression"
      ]
    },
    {
      "name": "sqlp_distinct_basic",
      "description": "Sqlp Distinct Basic",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"SELECT DISTINCT category FROM data ORDER BY category NULLS LAST\"",
      "args": [
        "data.csv",
        "SELECT DISTINCT category FROM data ORDER BY category NULLS LAST"
      ],
      "expected": {
        "data": [
          [
            "category"
          ],
          [
            "A"
          ],
          [
            "B"
          ],
          [
            "C"
          ],
          [
            "NULL"
          ]
        ]
      },
      "tags": [
        "basic"
      ]
    },
    {
      "name": "sqlp_distinct_multiple_columns",
      "description": "Sqlp Distinct Multiple Columns",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT DISTINCT category, subcategory FROM data ORDER BY category NULLS LAST, \\\\\n             subcategory\\\",\n        \"",
      "args": [
        "data.csv",
        "\n            \"SELECT DISTINCT category, subcategory FROM data ORDER BY category NULLS LAST, \\\n             subcategory\",\n        "
      ],
      "expected": {
        "data": [
          [
            "category",
            "subcategory"
          ],
          [
            "A",
            "x"
          ],
          [
            "B",
            "y"
          ],
          [
            "B",
            "z"
          ],
          [
            "C",
            "x"
          ],
          [
            "C",
            "y"
          ],
          [
            "NULL",
            "x"
          ],
          [
            "NULL",
            "y"
          ]
        ]
      }
    },
    {
      "name": "sqlp_distinct_with_nulls",
      "description": "Sqlp Distinct With Nulls",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"SELECT DISTINCT category FROM data ORDER BY category NULLS FIRST\"",
      "args": [
        "data.csv",
        "SELECT DISTINCT category FROM data ORDER BY category NULLS FIRST"
      ],
      "expected": {
        "data": [
          [
            "category"
          ],
          [
            "NULL"
          ],
          [
            "A"
          ],
          [
            "B"
          ],
          [
            "C"
          ]
        ]
      }
    },
    {
      "name": "sqlp_distinct_all_columns",
      "description": "Sqlp Distinct All Columns",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT DISTINCT * FROM data ORDER BY category NULLS LAST, subcategory, value, \\\\\n             status, score\\\",\n        \"",
      "args": [
        "data.csv",
        "\n            \"SELECT DISTINCT * FROM data ORDER BY category NULLS LAST, subcategory, value, \\\n             status, score\",\n        "
      ],
      "expected": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "NULL",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "NULL",
            "y",
            "700",
            "inactive",
            "80"
          ]
        ]
      }
    },
    {
      "name": "sqlp_distinct_on_basic",
      "description": "Sqlp Distinct On Basic",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT DISTINCT ON (category\"",
      "args": [
        "data.csv",
        "\n            \"SELECT DISTINCT ON (category"
      ],
      "expected": {
        "data": [
          [
            "category",
            "value",
            "status"
          ],
          [
            "A",
            "100",
            "active"
          ],
          [
            "B",
            "300",
            "active"
          ],
          [
            "C",
            "500",
            "active"
          ],
          [
            "NULL",
            "700",
            "inactive"
          ]
        ]
      },
      "tags": [
        "basic"
      ]
    },
    {
      "name": "sqlp_distinct_on_multiple_keys",
      "description": "Sqlp Distinct On Multiple Keys",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT DISTINCT ON (category, subcategory\"",
      "args": [
        "data.csv",
        "\n            \"SELECT DISTINCT ON (category, subcategory"
      ],
      "expected": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "NULL",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "NULL",
            "y",
            "700",
            "inactive",
            "80"
          ]
        ]
      }
    },
    {
      "name": "sqlp_distinct_on_with_nulls",
      "description": "Sqlp Distinct On With Nulls",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"SELECT DISTINCT ON (category) * FROM data ORDER BY category NULLS LAST, value DESC\"",
      "args": [
        "data.csv",
        "SELECT DISTINCT ON (category) * FROM data ORDER BY category NULLS LAST, value DESC"
      ],
      "expected": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "NULL",
            "y",
            "700",
            "inactive",
            "80"
          ]
        ]
      }
    },
    {
      "name": "sqlp_distinct_on_expression",
      "description": "Sqlp Distinct On Expression",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT DISTINCT ON (category\"",
      "args": [
        "data.csv",
        "\n            \"SELECT DISTINCT ON (category"
      ],
      "expected": {
        "data": [
          [
            "category",
            "value"
          ],
          [
            "A",
            "100"
          ],
          [
            "B",
            "300"
          ],
          [
            "C",
            "500"
          ],
          [
            "NULL",
            "700"
          ]
        ]
      }
    },
    {
      "name": "sqlp_distinct_with_aggregation",
      "description": "Sqlp Distinct With Aggregation",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT DISTINCT category, COUNT(*\"",
      "args": [
        "data.csv",
        "\n            \"SELECT DISTINCT category, COUNT(*"
      ],
      "expected": {
        "data": [
          [
            "category",
            "cnt"
          ],
          [
            "A",
            "3"
          ],
          [
            "B",
            "3"
          ],
          [
            "C",
            "2"
          ],
          [
            "NULL",
            "2"
          ]
        ]
      }
    },
    {
      "name": "sqlp_distinct_on_complex_ordering",
      "description": "Sqlp Distinct On Complex Ordering",
      "input": {
        "data": [
          [
            "category",
            "subcategory",
            "value",
            "status",
            "score"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "20"
          ],
          [
            "B",
            "y",
            "200",
            "active",
            "30"
          ],
          [
            "B",
            "y",
            "200",
            "inactive",
            "30"
          ],
          [
            "B",
            "z",
            "300",
            "active",
            "40"
          ],
          [
            "C",
            "x",
            "400",
            "inactive",
            "50"
          ],
          [
            "C",
            "y",
            "500",
            "active",
            "60"
          ],
          [
            "",
            "x",
            "600",
            "active",
            "70"
          ],
          [
            "",
            "y",
            "700",
            "inactive",
            "80"
          ],
          [
            "A",
            "x",
            "100",
            "active",
            "10"
          ]
        ],
        "filename": "data.csv"
      },
      "command": "qsv sqlp data.csv \"\n            \\\"SELECT DISTINCT ON (category\"",
      "args": [
        "data.csv",
        "\n            \"SELECT DISTINCT ON (category"
      ],
      "expected": {
        "data": [
          [
            "category",
            "value",
            "status"
          ],
          [
            "A",
            "100",
            "active"
          ],
          [
            "B",
            "300",
            "active"
          ],
          [
            "C",
            "500",
            "active"
          ],
          [
            "NULL",
            "700",
            "inactive"
          ]
        ]
      }
    }
  ]
}