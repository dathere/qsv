---
name: mcp-release-prep
description: Prepare an MCP server release by bumping versions across all files and updating changelog
disable-model-invocation: true
---

# MCP Server Release Preparation

Prepare an MCP server release by updating version numbers across all required files and generating a changelog entry. The MCP server version advances **independently** of the qsv binary version.

## Arguments

- `version` (required): The new MCP server version number (e.g., "16.2.0")
- `minimum_qsv_version` (optional): New minimum qsv binary version, if changing

All paths below are relative to `.claude/skills/`.

## Version Bump Checklist

### Core (must always update)

1. **`package.json`**: find `"version":` field — source of truth; `version.ts` reads this at runtime
2. **`manifest.json`**: find `"version":` field near top — must match package.json
3. **`.claude-plugin/plugin.json`**: find `"version":` field

### Conditional (only if minimum qsv binary version changes)

4. **`manifest.json`**: find `"minimum_qsv_version":` field

### Documentation (hardcoded versions to update)

5. **`README-MCP.md`**: search for `**Version**: X.Y.Z` near the bottom
6. **`docs/guides/MACOS-QUICK_START.md`**: search for download URLs and footer version (multiple occurrences)
7. **`docs/desktop/README-MCPB.md`**: search for download URLs and version badge (multiple occurrences)
8. **`docs/guides/DESKTOP_EXTENSION.md`**: add version history entry at the end of the version history section

## Changelog Entry

Add a new section at the top of `CHANGELOG.md` (in `.claude/skills/`) following this format:

```markdown
## [X.Y.Z] - YYYY-MM-DD

### Added
- (new features)

### Changed
- (changes to existing features)

### Fixed
- (bug fixes)
```

Find the last qsv release tag and use it to populate the changelog:

```bash
# Find the most recent qsv release tag
LAST_TAG=$(git describe --tags --match '[0-9]*' --abbrev=0 2>/dev/null || echo "")

# List relevant commits since that tag (or all commits from repo root if no tag exists)
git log --oneline --no-merges --grep="(mcp)" "${LAST_TAG:-$(git rev-list --max-parents=0 HEAD)}"..HEAD
```

Only commits with `(mcp)` in the title are relevant to MCP server releases.

## Verification Steps

After version bumps:

1. `npm run build` — TypeScript compilation succeeds
2. `npm test` — all tests pass
3. `npm run mcpb:package` — generates `qsv-mcp-server-X.Y.Z.mcpb`

## Important Notes

- MCP server version advances **independently** of qsv binary version
- `minimum_qsv_version` in manifest.json tracks binary compatibility, not server version
- Skill JSON files (`qsv/*.json`) are auto-generated by the **qsv binary** (`qsv --update-mcp-skills`), not by this skill — only bump those via `/release-prep`
- Update the `CLAUDE.md` **Document Version** and **Last Updated** fields if CLAUDE.md content changed in this release
- `version.ts` reads version from `package.json` at runtime — no need to edit `version.ts` directly
