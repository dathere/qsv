{
  "name": "qsv-schema",
  "version": "14.0.0",
  "description": "Infer either a JSON Schema Validation Draft 2020-12 (Example) or Polars Schema (Example) from CSV data. In JSON Schema Validation mode, it produces a `.schema.json` file replete with inferred data type & domain/range validation rules derived from `stats`. Uses multithreading to go faster if an index is present. See `validate` command to use the generated JSON Schema to validate if similar CSVs comply with the schema. With the `--polars` option, it produces a `.pschema.json` file that all polars commands (`sqlp`, `joinp` & `pivotp`) use to determine the data type of each column & to optimize performance. Both schemas are editable and can be fine-tuned. For JSON Schema, to refine the inferred validation rules. For Polars Schema, to change the inferred Polars data types.",
  "category": "validation",
  "command": {
    "binary": "qsv",
    "subcommand": "schema",
    "args": [
      {
        "name": "input",
        "type": "file",
        "required": true,
        "description": ""
      }
    ],
    "options": [
      {
        "flag": "--dates-whitelist",
        "type": "string",
        "description": "The case-insensitive patterns to look for when shortlisting fields for date inference. i.e. if the field's name has any of these patterns, it is shortlisted for date inferencing. Set to \"all\" to inspect ALL fields for date/datetime types.",
        "default": "date,time,due,open,close,created"
      },
      {
        "flag": "--delimiter",
        "type": "string",
        "description": "The field delimiter for reading CSV data. Must be a single character."
      },
      {
        "flag": "--enum-threshold",
        "type": "string",
        "description": "Cardinality threshold for adding enum constraints. Enum constraints are compiled for String & Integer types.",
        "default": "50"
      },
      {
        "flag": "--force",
        "type": "flag",
        "description": "Force recomputing cardinality and unique values even if stats cache file exists and is current."
      },
      {
        "flag": "--help",
        "type": "flag",
        "description": "Display this message"
      },
      {
        "flag": "--ignore-case",
        "type": "flag",
        "description": "Ignore case when compiling unique values for enum constraints. Do note however that the `validate` command is case-sensitive when validating against enum constraints."
      },
      {
        "flag": "--jobs",
        "type": "string",
        "description": "The number of jobs to run in parallel. When not set, the number of jobs is set to the number of CPUs detected."
      },
      {
        "flag": "--memcheck",
        "type": "flag",
        "description": "Check if there is enough memory to load the entire CSV into memory using CONSERVATIVE heuristics."
      },
      {
        "flag": "--no-headers",
        "type": "flag",
        "description": "When set, the first row will not be interpreted as headers. Namely, it will be processed with the rest of the rows. Otherwise, the first row will always appear as the header row in the output."
      },
      {
        "flag": "--output",
        "type": "string",
        "description": "Write output to <file> instead of using the default filename. For JSON Schema, the default is <input>.schema.json. For Polars schema, the default is <input>.pschema.json."
      },
      {
        "flag": "--pattern-columns",
        "type": "string",
        "description": "Select columns to derive regex pattern constraints. That is, this will create a regular expression that matches all values for each specified column. Columns are selected using `select` syntax (see `qsv select --help` for details)."
      },
      {
        "flag": "--polars",
        "type": "flag",
        "description": "Infer a Polars schema instead of a JSON Schema. This option is only available if the `polars` feature is enabled. The generated Polars schema will be written to a file with the `.pschema.json` suffix appended to the input filename."
      },
      {
        "flag": "--prefer-dmy",
        "type": "flag",
        "description": "Prefer to parse dates in dmy format. Otherwise, use mdy format."
      },
      {
        "flag": "--stdout",
        "type": "flag",
        "description": "Send generated JSON schema file to stdout instead."
      },
      {
        "flag": "--strict-dates",
        "type": "flag",
        "description": "Enforce Internet Datetime format (RFC-3339) for detected date/datetime columns. Otherwise, even if columns are inferred as date/datetime, they are set to type \"string\" in the schema instead of \"date\" or \"date-time\"."
      },
      {
        "flag": "--strict-formats",
        "type": "flag",
        "description": "Enforce JSON Schema format constraints for detected email, hostname, and IP address columns. When enabled, String fields are checked against email, hostname, IPv4, and IPv6 formats. Format constraints are only added if ALL unique values in the field match the detected format."
      }
    ]
  },
  "hints": {
    "streamable": false,
    "indexed": true,
    "memory": "proportional"
  }
}